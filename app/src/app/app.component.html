<div>
  <mat-toolbar class="header">
    <button mat-icon-button (click)="sidenav.toggle()">
      <mat-icon>menu</mat-icon>
    </button>
    <span><img src="assets/img/logo.png" alt="Logo" style="width:48px;height:48px;"></span>
    <span style="text-indent: 5%;">Guess That Song</span>
    <span class="spacer"></span>

    <button mat-button (click)="login()" *ngIf="!isLoggedIn">
      <span style="display: flex; align-items: center;">Login
        <mat-icon style="margin-left: 5px">login</mat-icon>
      </span>
    </button>


    <button mat-button (click)="isLoggedIn = !isLoggedIn" *ngIf="isLoggedIn">
      <span style="display: flex; align-items: center;">Welcome, {{userName}}!
        <mat-icon style="margin-left: 5px">logout</mat-icon>
      </span>
    </button>
  </mat-toolbar>

  <mat-sidenav-container class="container">
    <mat-sidenav #sidenav mode="side" class="sidenav">
      <h1>Choose your game options:</h1>
      <hr style="margin-bottom: 10px;" />

      <span class="game-options">
        <mat-slider min="1" max="5" step="1" showTickMarks style="margin-bottom: 10px;">
          <mat-label>Number of Rounds: {{numberOfRounds}}</mat-label>
          <input matSliderThumb [(ngModel)]="numberOfRounds" [disabled]="isGameInProgress"/>
        </mat-slider>
      </span>
      <br /> <br />

      <span class="game-options">
        <mat-slider min="3" max="10" step="1" showTickMarks style="margin-bottom: 10px;">
          <mat-label>Number of Seconds Per Round: {{secondsPerRound}}</mat-label>
          <input matSliderThumb [(ngModel)]="secondsPerRound" [disabled]="isGameInProgress"/>
        </mat-slider>
      </span>
      <br /> <br />

      <span class="game-options">
        <mat-label>Song Mode</mat-label><br />
        <mat-radio-group [(ngModel)]="filterMode" style="padding: 15px" [disabled]="isGameInProgress">
          <mat-radio-button value="decade">Decade</mat-radio-button>
          <mat-radio-button value="genre">Genre</mat-radio-button>
        </mat-radio-group>
      </span>
      <br /> <br />

      <span class="game-options">
        <mat-label>Decade</mat-label><br />
        <mat-select [(ngModel)]="selectedDecade" style="width: 75%; padding-left: 20px" [disabled]="filterMode !== 'decade' || isGameInProgress">
          <mat-option *ngFor="let decade of decades" [value]="decade.value">{{decade.viewValue}}</mat-option>
        </mat-select>
      </span>
      <br /> <br />

      <span class="game-options">
        <mat-label>Genre</mat-label><br />
        <mat-select [(ngModel)]="selectedGenre" style="width: 75%; padding-left: 20px" [disabled]="filterMode !== 'genre' || isGameInProgress">
          <mat-option *ngFor="let genre of genres" [value]="genre.value">{{genre.viewValue}}</mat-option>
        </mat-select>
      </span>
      <br /> <br />
    </mat-sidenav>

    <mat-sidenav-content>
      <div style="margin-top: 20px; margin-left:10px">
        <h1 *ngIf="!isLoggedIn">You aren't logged in. Please login</h1>

        <div *ngIf="isLoggedIn">
          <div *ngIf="!isGameInProgress && !isGameOver">
            <h1 style="text-align: center">
              It's time to play the game...
            </h1>

            <div class="center">
              <button mat-button style="width: 250px; height: 250px; background-color: green;" (click)="startGame()">
                PLAY
              </button>
            </div>
          </div>
          <div *ngIf="isGameInProgress">
            <img [src]="albumCoverSrc" class="center" style="width: 300px; height: 300px; margin: auto" />
            <app-video-player *ngIf="isRoundInProgress" [videoId]="videoId" style="visibility: hidden"
              class="center"></app-video-player>

            <div *ngIf="!isRoundInProgress">
              <mat-form-field class="center"
                style="margin-left: auto; margin-right: auto; margin-top: 20px; width: 500px">
                <mat-label>Enter your guess...</mat-label>
                <input matInput type="text" placeholder="Song name" [(ngModel)]="guess" />
              </mat-form-field>

              <button mat-button class="center submit-btn" (click)="submitGuess()">Submit</button>
            </div>

            <br />
            <p>Your current score: <b>{{score}}</b></p>
          </div>

          <div *ngIf="isGameOver">
            <h1 class="center">Game Over!</h1>
            <hr /><br />
            <p>Your final score: <b>{{score}}</b></p>

            <table mat-table [dataSource]="guesses">
              <ng-container matColumnDef="round">
                <th mat-header-cell *matHeaderCellDef>Round</th>
                <td mat-cell *matCellDef="let elem">{{elem.round}}</td>
              </ng-container>

              <ng-container matColumnDef="userGuess">
                <th mat-header-cell *matHeaderCellDef>Your Guess</th>
                <td mat-cell *matCellDef="let elem">{{elem.guess}}</td>
              </ng-container>

              <ng-container matColumnDef="actual">
                <th mat-header-cell *matHeaderCellDef>Actual Title</th>
                <td mat-cell *matCellDef="let elem">{{elem.title}}</td>
              </ng-container>

              <ng-container matColumnDef="artist">
                <th mat-header-cell *matHeaderCellDef>Artist</th>
                <td mat-cell *matCellDef="let elem">{{elem.artist}}</td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="['round', 'userGuess', 'actual', 'artist']"></tr>
              <tr mat-row *matRowDef="let row; columns: ['round', 'userGuess', 'actual', 'artist']"></tr>
            </table>
            <br />

            <div class="center">
              <button mat-button style="width: 250px; height: 250px; background-color: green;" (click)="startGame()">
                PLAY AGAIN?
              </button>
            </div>
          </div>
        </div>
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
  <mat-sidenav #rightSidenav mode="side" position="end" opened class="about">
    <div style="padding: 16px;">
      <h2>
        <b>
          <div *ngIf="filterMode === 'decade'">{{ getDecadeViewValue(selectedDecade) }}</div>
          <div *ngIf="filterMode === 'genre'">{{ getGenreViewValue(selectedGenre) }}</div>
        </b>
        {{ filterMode | titlecase }}
      </h2>
      <p>In <b>{{ numberOfRounds }}</b> rounds you will listen to a song for
        <b>{{ secondsPerRound }}</b> second(s). After you listen to the song, type your guess!
      </p>
    <br>
    <br>
    <h3>About</h3>
    <p>Guess That Song is a project for Web Dev by Logan Shafer, Brandon Torralba, and Yer Yang</p>
    </div>
  </mat-sidenav>
  <mat-toolbar class="footer">SEIS 622 - 01 | Fall 2024 | Shafer, Torralba, Yang</mat-toolbar>
</div>